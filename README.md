# Personalized Nutrition Framework for Endurance Exercise

This repository contains the official implementation of the data-driven framework described in the paper: **"Data-Augmented Machine Learning Validates Personalized Carbohydrate-Protein Supplement for Endurance Exercisers"**.

The framework utilizes a Range-Restricted Generative Adversarial Network (RR-GAN) for physiological data augmentation and an eXtreme Gradient Boosting (XGBoost) model to generate personalized nutritional recommendations (Carbohydrate and Protein intake rates) for rowing performance optimization.

## ⚠️ Important Disclaimer regarding Data & Reproducibility

To comply with ethical standards and protect participant privacy, the **original individual-level dataset used in the manuscript cannot be publicly shared**.

Therefore, this repository provides:
1.  **Refactored Code:** We have isolated and cleaned the core algorithmic scripts from the original doctoral project to ensure ease of use and clarity.
2.  **Synthetic Data:** The file `data/original_cohort_data.xlsx` contains **synthetic (dummy) data**. This dataset mirrors the statistical structure, feature definitions, and formatting of the real-world cohort but does not contain real patient records.

**Note:** Consequently, running this code will verify the **methodological workflow** and algorithmic logic. However, the specific quantitative outputs (e.g., MSE values, feature importance rankings) will differ from the results reported in the manuscript, which were derived from the confidential, real-world dataset.

## Repository Structure

The project is organized into the following directories:

* **`data/`**: Contains the datasets required for the workflow.
    * `original_cohort_data.xlsx`: The synthetic dataset representing the initial cohort.
    * `synthetic_augmented_data.xlsx`: (Output) The augmented dataset generated by RR-GAN.
    * `feature_constraints.xlsx`: Defines the physiological boundaries (min/max) for the RR-GAN to ensure realistic data generation.
* **`RR-GAN/`**: Contains the source code for data augmentation.
    * `data_augmentation_rrgan.py`: script to train the GAN and generate augmented data.
* **`modeling/`**: Contains the machine learning workflow.
    * `performance_prediction_xgboost.ipynb`: The main notebook that trains the XGBoost model, evaluates performance, and includes the **Application Module** for new subject prediction.
* **`input/`**: Contains tools for practical application.
    * `new_subject_input_template.xlsx`: A template for users to input new subject data (e.g., height, weight, HRV) to receive personalized recommendations.
    * `README.md`: Detailed guide on how to fill out the template.
* **`output/`**: Stores all generated artifacts, including trained models (`.json`), visualization plots (Loss curves, Decision trees), and text reports.

## Getting Started

### Prerequisites
The code requires Python 3.8+ and the following libraries:
* pandas
* numpy
* xgboost
* torch (PyTorch)
* scikit-learn
* matplotlib
* seaborn
* graphviz (and python-pydot)

### Usage Workflow

To replicate the framework or use it for new predictions, follow this sequence:

#### 1. Data Augmentation (RR-GAN)
Navigate to the `RR-GAN` folder and run the script to expand the dataset.
```bash
python RR-GAN/data_augmentation_rrgan.py

```

*Input:* `data/original_cohort_data.xlsx` & `data/feature_constraints.xlsx`
*Output:* `data/synthetic_augmented_data.xlsx`

#### 2. Model Training & Evaluation

Run the Jupyter Notebook in the `modeling` folder. This will train the XGBoost model using the augmented data.

* **File:** `modeling/performance_prediction_xgboost.ipynb`
* **Output:** The script will generate loss curves, feature importance plots, and the decision tree visualization in the `output/` directory.

#### 3. Generating Personalized Recommendations (Application Module)

To generate an optimal nutritional strategy for a new athlete:

1. Go to the `input/` folder and open `new_subject_input_template.xlsx`.
2. Fill in the subject's physiological and anthropometric data (do not modify column order).
3. Save the file.
4. Run the final module in the `modeling/performance_prediction_xgboost.ipynb` notebook.
5. The optimal CHO and PRO intake rates will be printed and saved to `output/optimal_recommendation_result.txt`.


## License

This project is licensed under the MIT License - see the LICENSE file for details.

